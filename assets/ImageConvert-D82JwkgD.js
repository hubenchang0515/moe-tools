import{j as e,y as l,u as U,r as x,B as f,P as C}from"./index-DsbjQ4hc.js";import{C as R}from"./Container-IRi_bWNG.js";import{T as k,a as y,b as B,c as j,d as i,e as v}from"./TableRow-BMEHiveg.js";import"./useThemeProps-DnLH8txk.js";function T(t){return e.jsxs(l,{variant:"contained",component:"label",children:[t.children,e.jsx("input",{type:"file",style:{clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1},onChange:t.onChange})]})}function E(t){const c=new Uint8Array(24+t.length),n=new DataView(c.buffer);return n.setUint16(0,0,!0),n.setUint16(2,1,!0),n.setUint16(4,1,!0),n.setUint8(6,0),n.setUint8(7,0),n.setUint8(8,0),n.setUint8(9,0),n.setUint16(10,0,!0),n.setUint16(12,32,!0),n.setUint32(14,t.length,!0),n.setUint32(18,24,!0),c.set(t,24),c}function O(){const{t}=U(),c=x.useRef(null),n=x.useRef(null),p=x.useCallback(o=>{if(!o.target.files||o.target.files.length==0)return;const a=o.target.files[0],s=URL.createObjectURL(a),r=new Image;c.current.src=s,r.src=s,r.onload=()=>{var u;if(!n.current)return;const h=(u=n.current)==null?void 0:u.getContext("2d");h&&(n.current.width=r.width,n.current.height=r.height,h.drawImage(r,0,0))}},[c,n]),d=x.useCallback(o=>()=>{n.current&&(o==="ico"?n.current.toBlob(a=>{if(!a)return;const s=new FileReader;s.onload=r=>{var m;const h=(m=r.target)==null?void 0:m.result,u=E(new Uint8Array(h)),w=new Blob([u]),b=URL.createObjectURL(w),g=document.createElement("a");g.href=b,g.download="image.ico",g.click()},s.readAsArrayBuffer(a)},"image/png",1):n.current.toBlob(a=>{if(!a)return;const s=URL.createObjectURL(a),r=document.createElement("a");r.href=s,r.download=`image.${o}`,r.click()},`image/${o}`,1))},[n]);return e.jsx(R,{maxWidth:"xl",sx:{height:"100%",paddingY:1},children:e.jsxs(f,{height:"100%",display:"flex",flexDirection:"column",gap:1,children:[e.jsx(f,{sx:{flex:1,display:"flex",overflow:"hidden",justifyContent:"center"},children:e.jsx("img",{ref:c,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),e.jsx(T,{onChange:p,children:t("common.open")}),e.jsx(k,{component:C,sx:{flexShrink:0},children:e.jsxs(y,{children:[e.jsx(B,{children:e.jsxs(j,{children:[e.jsx(i,{align:"center",children:"PNG(.png)"}),e.jsx(i,{align:"center",children:"JPEG(.jpg)"}),e.jsx(i,{align:"center",children:"WEBP(.webp)"}),e.jsx(i,{align:"center",children:"ICON(.ico)"})]})}),e.jsx(v,{children:e.jsxs(j,{children:[e.jsx(i,{align:"center",children:e.jsx(l,{variant:"text",onClick:d("png"),children:t("common.download")})}),e.jsx(i,{align:"center",children:e.jsx(l,{variant:"text",onClick:d("jpeg"),children:t("common.download")})}),e.jsx(i,{align:"center",children:e.jsx(l,{variant:"text",onClick:d("webp"),children:t("common.download")})}),e.jsx(i,{align:"center",children:e.jsx(l,{variant:"text",onClick:d("ico"),children:t("common.download")})})]})})]})}),e.jsx(f,{sx:{display:"none"},children:e.jsx("canvas",{ref:n})})]})})}export{O as default};
