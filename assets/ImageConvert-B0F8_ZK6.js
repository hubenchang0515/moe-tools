import{j as e,y as d,u as U,r as l,B as f,P as C}from"./index-C9DZtc18.js";import{C as y}from"./Container-CUjVaddQ.js";import{T as R,a as k,b as v,c as j,d as c,e as B}from"./TableRow-BI0Re9dX.js";import"./useThemeProps-BjWb88gk.js";function T(n){return e.jsxs(d,{variant:"contained",component:"label",children:[n.children,e.jsx("input",{type:"file",style:{clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1},onChange:n.onChange})]})}function E(n){const o=new Uint8Array(24+n.length),t=new DataView(o.buffer);return t.setUint16(0,0,!0),t.setUint16(2,1,!0),t.setUint16(4,1,!0),t.setUint8(6,0),t.setUint8(7,0),t.setUint8(8,0),t.setUint8(9,0),t.setUint16(10,0,!0),t.setUint16(12,32,!0),t.setUint32(14,n.length,!0),t.setUint32(18,24,!0),o.set(n,24),o}function O(){const{t:n}=U(),o=l.useRef(null),t=l.useRef(null);l.useEffect(()=>{var i;document.title=`${n("title")} - ${n("pages.image-format-convert")}`,(i=document.querySelector('meta[name="description"]'))==null||i.setAttribute("content",n("description.image-format-convert"))},[n]);const p=l.useCallback(i=>{if(!i.target.files||i.target.files.length==0)return;const a=i.target.files[0],s=URL.createObjectURL(a),r=new Image;o.current.src=s,r.src=s,r.onload=()=>{var x;if(!t.current)return;const h=(x=t.current)==null?void 0:x.getContext("2d");h&&(t.current.width=r.width,t.current.height=r.height,h.drawImage(r,0,0))}},[o,t]),u=l.useCallback(i=>()=>{t.current&&(i==="ico"?t.current.toBlob(a=>{if(!a)return;const s=new FileReader;s.onload=r=>{var g;const h=(g=r.target)==null?void 0:g.result,x=E(new Uint8Array(h)),w=new Blob([x]),b=URL.createObjectURL(w),m=document.createElement("a");m.href=b,m.download="image.ico",m.click()},s.readAsArrayBuffer(a)},"image/png",1):t.current.toBlob(a=>{if(!a)return;const s=URL.createObjectURL(a),r=document.createElement("a");r.href=s,r.download=`image.${i}`,r.click()},`image/${i}`,1))},[t]);return e.jsx(y,{maxWidth:"xl",sx:{height:"100%",paddingY:1},children:e.jsxs(f,{height:"100%",display:"flex",flexDirection:"column",gap:1,children:[e.jsx(f,{sx:{flex:1,display:"flex",overflow:"hidden",justifyContent:"center"},children:e.jsx("img",{ref:o,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),e.jsx(T,{onChange:p,children:n("common.open")}),e.jsx(R,{component:C,sx:{flexShrink:0},children:e.jsxs(k,{children:[e.jsx(v,{children:e.jsxs(j,{children:[e.jsx(c,{align:"center",children:"PNG(.png)"}),e.jsx(c,{align:"center",children:"JPEG(.jpg)"}),e.jsx(c,{align:"center",children:"WEBP(.webp)"}),e.jsx(c,{align:"center",children:"ICON(.ico)"})]})}),e.jsx(B,{children:e.jsxs(j,{children:[e.jsx(c,{align:"center",children:e.jsx(d,{variant:"text",onClick:u("png"),children:n("common.download")})}),e.jsx(c,{align:"center",children:e.jsx(d,{variant:"text",onClick:u("jpeg"),children:n("common.download")})}),e.jsx(c,{align:"center",children:e.jsx(d,{variant:"text",onClick:u("webp"),children:n("common.download")})}),e.jsx(c,{align:"center",children:e.jsx(d,{variant:"text",onClick:u("ico"),children:n("common.download")})})]})})]})}),e.jsx(f,{sx:{display:"none"},children:e.jsx("canvas",{ref:t})})]})})}export{O as default};
